<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>AR Occlusion demo</title>
    <script src='https://aframe.io/releases/0.9.2/aframe.min.js'></script>
    <script src="https://raw.githack.com/jeromeetienne/AR.js/master/aframe/build/aframe-ar.min.js"></script>
    <script src="https://raw.githack.com/donmccurdy/aframe-extras/master/dist/aframe-extras.loaders.min.js"></script>
    <script>THREEx.ArToolkitContext.baseURL = 'https://raw.githack.com/jeromeetienne/ar.js/master/three.js/'</script>
    <link rel="stylesheet" href="./index.css">
</head>

<body style='margin: 0; overflow: hidden;'>

    <div class="onoffswitch">
        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" value="geomatics" tabindex="0" onchange="getBuilding(this)" >
        <label class="onoffswitch-label" for="myonoffswitch">
            <span class="onoffswitch-inner"></span>
            <span class="onoffswitch-switch"></span>
        </label>
    </div>

    <a-scene
        vr-mode-ui="enabled: false"
		embedded
        arjs='sourceType: webcam; sourceWidth:1280; sourceHeight:960; displayWidth: 1280; displayHeight: 960; debugUIEnabled: false;'>
        
        <a-camera gps-camera rotation-reader></a-camera>

        <!--<a-entity gltf-model="https://dylan1211-hub.github.io/AR-Occlusion-Test/3D_model/wall.gltf" rotation="0 0 0" scale="1 1 1" gps-entity-place="longitude: 120.219143; latitude: 22.999803;" 
        animation-mixer /> 小正包子22.998328422050523, 120.22767385061094-->  <!--總圖前草坪22.999803, 120.219143-->

        <!--<a-entity gltf-model="https://dylan1211-hub.github.io/AR-Occlusion-Test/3D_model/Kirby.gltf" rotation="0 0 0" scale="20 20 20" gps-entity-place="longitude: 120.22789847379012; latitude: 22.998810029888585;" 
        material="transparent: true; opacity: 0.5" animation-mixer/>  總圖 22.999046, 120.219783-->  <!--ㄚ頭麵店後面longitude: 120.22789847379012; latitude: 22.998810029888585-->

        <!--<a-box color="#4ecef9" depth="4" height="4" width="4"  gps-entity-place="longitude:120.22761791880879; latitude: 22.99856170145283;" 
        material="transparent: true; opacity: 0" animation-mixer></a-box> ㄚ頭麵店longitude: 120.22761791880879; latitude: 22.99856170145283--> <!--總圖前草坪 120.21967,22.99910-->

        <a-sphere color="#e23232" radius="1" gps-entity-place="longitude: 120.219783; latitude: 22.99965;" 
        material="transparent: true;" animation-mixer></a-box> <!--ㄚ頭麵店後面longitude: 120.22789847379012; latitude: 22.998810029888585--> <!--總圖 120.219783,22.99965-->                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            
    
	</a-scene>
    <script>
        /*let building=[
            {
                name: 'Geomatics',
                lat: 22.99910,
                lon: 120.21967,
            }
        ];*/
        var b;
        function getBuilding(building){
            if(building.checked===true){
                console.log(building.value+" checked")

                function renderBuilding(building){
                    console.log("render building");
                    b=1;
                    let scene =document.querySelector('a-scene');
                    const latitude = 22.99910;
					const longitude = 120.21967;
                    const box = document.createElement('a-box');
                    box.setAttribute('gps-entity-place', `latitude: ${latitude}; longitude: ${longitude}`);
                    box.setAttribute('color', '#4ecef9');
                    box.setAttribute('depth', '4');
                    box.setAttribute('height', '4');
                    box.setAttribute('width', '4');
                    box.setAttribute('material', 'transparent: true; opacity: 0.1');
                    box.addEventListener('loaded', () => {
							window.dispatchEvent(new CustomEvent('gps-entity-place-loaded'));
							console.log("render box");
						});
                    scene.appendChild(box);
                }

                renderBuilding(building);
            }

            else{
                console.log(building.value+" unchecked")
                if(b=1){
                    let scene =document.querySelector('a-scene');
                    let box =document.querySelector('a-box');
                    scene.removeChild(box);
                    b=0;
                    console.log("remove box")
                }
                else{
                    console.log("nothing happened")
                }
            }
        }
    </script>
</body>